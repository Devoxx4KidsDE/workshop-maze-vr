<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>D4K - MazeVR</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="/node_modules/systemjs/dist/system.js"></script>
    <script type="text/javascript">
      function microAjax(B,A){this.bindFunction=function(E,D){return function(){return E.apply(D,[D])}};this.stateChange=function(D){if(this.request.readyState==4){this.callbackFunction(this.request.responseText)}};this.getRequest=function(){if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP")}else{if(window.XMLHttpRequest){return new XMLHttpRequest()}}return false};this.postBody=(arguments[2]||"");this.callbackFunction=A;this.url=B;this.request=this.getRequest();if(this.request){var C=this.request;C.onreadystatechange=this.bindFunction(this.stateChange,this);if(this.postBody!==""){C.open("POST",B,true);C.setRequestHeader("X-Requested-With","XMLHttpRequest");C.setRequestHeader("Content-type","application/x-www-form-urlencoded");C.setRequestHeader("Connection","close")}else{C.open("GET",B,true)}C.send(this.postBody)}};
      var currentVersion;
      setInterval(function() {
        microAjax('/version', function(res) {
          if (!currentVersion) {
            currentVersion = res;
          } else if (currentVersion != res) {
            location.reload();
          }
        });
      }, 5000);
    </script>
</head>
<body>

    <div id="loading">
        <p>Lade...</p>
    </div>

    <script>
        const nodeModulesPath = './../node_modules';
        const config = {
            baseUrl: './app',
            meta: {
                'three': {
                    format: 'global',
                    exports: 'THREE'
                }
            },
            map: {
                'plugin-babel'        : nodeModulesPath + '/systemjs-plugin-babel/plugin-babel.js',
                'systemjs-babel-build': nodeModulesPath + '/systemjs-plugin-babel/systemjs-babel-browser.js',
                'three'               : nodeModulesPath + '/three/build/three.min.js',
                'three/examples'      : nodeModulesPath + '/three/examples',
                'webvr-polyfill'      : nodeModulesPath + '/webvr-polyfill/src/main.js',
                'webvr-boilerplate'   : nodeModulesPath + '/webvr-boilerplate/src/main.js',
                'es6-promise'         : nodeModulesPath + '/es6-promise/dist/es6-promise.min.js',
                'object-assign'       : nodeModulesPath + '/object-assign/index.js'
            },
            transpiler: 'plugin-babel'
        };
        System.defaultJSExtensions = true;
        SystemJS.config (config);
        System.import ('app');
    </script>

</body>
</html>
